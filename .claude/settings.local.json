{
  "permissions": {
    "allow": [
      "Bash(ssh root@164.92.225.137 \"docker exec planner_postgres psql -U planner -d planner -c ''SELECT id, title, deadline, status, user_id FROM tasks ORDER BY created_at DESC LIMIT 10;''\")",
      "Bash(ssh root@164.92.225.137 \"tail -200 /root/business-planner/app.log | grep -A 5 ''node_parse_complete''\")",
      "Bash(ssh root@164.92.225.137 \"tail -200 /root/business-planner/app.log | grep -B 3 ''task_parsed''\")",
      "Bash(git commit -m \"Fix deadline parsing: convert GPT date string to datetime\n\nProblem: Tasks created via voice had NULL deadline, so /today command found no tasks.\n\nRoot cause:\n- GPT returns ''deadline'': ''2025-10-20'' (date string)\n- ParsedTask expected ''deadline_text'' but got ''deadline''  \n- No conversion from string to datetime object\n\nChanges:\n- src/ai/parsers/task_parser.py: Updated ParsedTask model\n  - deadline_text → deadline (matches GPT output)\n  - project_name → project\n  - assigned_to_name → assigned_to\n  - Added deadline to logging\n\n- src/ai/graphs/voice_task_creation.py: \n  - parse_task_node: Updated field names (parsed_deadline instead of parsed_deadline_text)\n  - create_task_db_node: Added deadline string → datetime conversion\n    - Parses ISO date string (e.g. ''2025-10-20'')\n    - Sets time to end of day (23:59:59)\n    - Generates deadline_text for display\n  - format_response_node: Updated to use parsed_deadline with datetime conversion\n\nNow tasks created with ''сегодня'' will have deadline set correctly and appear in /today\")",
      "Bash(ssh root@164.92.225.137 \"docker exec planner_postgres psql -U planner -d planner -c \"\"UPDATE tasks SET deadline = ''2025-10-20 23:59:59'' WHERE id IN (4, 5);\"\"\")",
      "Bash(ssh root@164.92.225.137 \"docker exec planner_postgres psql -U planner -d planner -c ''SELECT id, title, deadline, status FROM tasks ORDER BY id DESC LIMIT 5;''\")",
      "Bash(ssh root@164.92.225.137 \"tail -100 /root/business-planner/app.log | grep -A 10 ''command_today''\")",
      "Bash(git commit -m \"Fix /today command: member_id → assigned_to\n\n- Changed task.member_id to task.assigned_to (correct field name)\n- Fixes ''Task object has no attribute member_id'' error\")",
      "Bash(git commit -m \"Redesign message formatting: remove emojis, add priority display\n\nChanges based on user preference for clean, professional text formatting:\n\n1. Voice task creation response (voice_task_creation.py):\n   - Removed all emojis from success message\n   - Added priority field (ВЫСОКИЙ/СРЕДНИЙ/НИЗКИЙ/ОТЛОЖЕННЫЙ)\n   - Clean structured format with aligned fields:\n     ЗАДАЧА СОЗДАНА\n     [task title]\n     Бизнес:      [name]\n     Приоритет:   [level]\n     Дедлайн:     [date]\n     Исполнитель: [name]\n     Время:       ~[duration] (точность)\n\n2. /today command (command_handler.py):\n   - Removed emojis from message and buttons\n   - Added priority display in section headers [ВЫСОКИЙ] [СРЕДНИЙ] etc\n   - Structured layout with separators (======, ------)\n   - Clean field labels: Бизнес, Время, ID\n   - Button text without emojis: Завершить, Изменить, Перенести, Удалить\n\n3. Error messages:\n   - Changed from emoji (❌) to [ОШИБКА] prefix\n   - Consistent across all error messages\n\n4. Voice handler buttons (voice_handler.py):\n   - Removed emojis from all inline buttons\n   - Clean text: Завершить, Изменить, Перенести, Удалить\n\nResult: Professional, structured text formatting without emojis, with clear priority indication\")"
    ],
    "deny": [],
    "ask": []
  }
}
